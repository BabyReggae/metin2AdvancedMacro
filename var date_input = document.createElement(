var date_input = document.createElement("input");
date_input.type = "datetime-local";
date_input.value = Date.now();
date_input.step = "1";

var milli_input = document.createElement("input");
milli_input.type = "number";
milli_input.value = 0;
milli_input.min = "0";
milli_input.max = "900";
milli_input.step = "100";
milli_input.style.maxWidth = "50px";
milli_input.style.marginLeft = "10px";

var validation_btn = document.createElement("button");
validation_btn.innerHTML = "Planifier";
validation_btn.style.backgroundColor = "green";
validation_btn.style.color = "ghostWhite";
validation_btn.style.marginLeft = "10px";


// ------------------
validation_btn.addEventListener ("click", function(e) {
    
    
    let impactDate_now = document.getElementById('date_arrival').firstElementChild.innerHTML;
    
    //recup la partie eg : '00:00:00'  d'une string comme eg : 'aujourd'hui 00:00:00'
    // UTA = User Time Array
    let UTA = impactDate_now.toString().substring( impactDate_now.length - 8 , impactDate_now.length ).split(':');
    let guessed_day = impactDate_now.toString().substring( 0 , impactDate_now.length - 11 );
    
    let now_dt = Date.now();
    impactDate_now = new Date(now_dt);
    impactDate_now.setHours(UTA[0]);
    impactDate_now.setMinutes(UTA[1]);
    impactDate_now.setSeconds(UTA[2]);

    let impactDate_future = new Date(date_input.value).getTime();
    let elapse = impactDate_future - impactDate_now.getTime();
    //si time est négatif, c'est que c'est "demain" par "aujourf'hui"
    if( elapse < 0 ) elapse = elapse + (86400*1000);
    validation_btn.innerHTML = "OK-enregistré";
    validation_btn.disabled = true;


    setTimeout( function(){
        document.getElementById('troop_confirm_submit').click();
    } ,  elapse + 500 );// need to be fix
});

const target =document.getElementById('troop_confirm_submit');
target.parentNode.appendChild(date_input);
target.parentNode.appendChild(milli_input);
target.parentNode.appendChild(validation_btn);
